(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(l){if(l.ep)return;l.ep=!0;const n=s(l);fetch(l.href,n)}})();const h=document.getElementById("playersForm"),a=document.getElementById("playerList"),p=document.getElementById("getRandomPlayer"),y=document.getElementById("selectedPlayer"),P=document.getElementById("resetGame"),L=document.getElementById("deletePlayerList"),f=document.getElementById("detailsAddPlayers"),E=document.getElementById("playersCount"),u=document.getElementById("lastResult");h.addEventListener("submit",t=>{t.preventDefault();for(const e of t.target.children)if(e.id==="players"){const s=v(e);I(s),e.value="",f.open=!1}c(a)});a.addEventListener("click",t=>{(t.target.type==="button"||t.target.closest("button").type==="button")&&b(t.target.closest("li").id)});p.addEventListener("click",async()=>{await B()});P.addEventListener("click",()=>{T()});L.addEventListener("click",()=>{x()});const i=()=>JSON.parse(localStorage.getItem("players"))||[],m=t=>{localStorage.setItem("players",JSON.stringify(t))},I=t=>{let e=t.split(/\s*,|\n/);return e=e.filter(s=>s.trim()),e=e.map(s=>({id:R(),name:s,selected:!1,lastResult:!1})),e=[...i(),...e],m(e),e},v=t=>{const e=t.value;if(/<[^>]+>/.test(e))throw new Error("El contenido debe ser solo texto separado por comas o saltos de línea");return e},b=t=>{const e=i(),s=e.findIndex(o=>o.id===t);e.splice(s,1),m(e),c(a)},c=t=>{t.innerHTML="";const e=i();e.length>0&&(f.open=!1);let s="<ol>";e.forEach(o=>{s+=`
                    <li class="${o.selected?"has-been-selected":""}" id="${o.id}">
                        <span>${o.name}</span>
                        <button class="btn-danger" type="button">
                            x
                        </button>
                    </li>
                `}),s+="</ol>",E.textContent=`(${e.length})`,t.innerHTML=s},R=(t=6)=>Math.random().toString(36).substring(2,t+2),g=()=>{const t=i();return t[Math.floor(Math.random()*t.length)]},B=async()=>{const t=i();if(t.length<=0)return;if(c(a),!t.find(r=>r.selected===!1)){alert("Todos los jugadores ya han participado al menos una vez.");return}let s=g();for(;s.selected;)s=g();const o=document.querySelectorAll("ol li");o.forEach(r=>{r.classList.remove("highlighted")});const l=2e3,n=Date.now()+l,d=setInterval(()=>{let r=Math.floor(Math.random()*o.length);for(;t[r].selected;)r=Math.floor(Math.random()*o.length);o[r].classList.add("highlighted"),setTimeout(()=>{o[r].classList.remove("highlighted")},100),Date.now()>=n&&clearInterval(d)},200);await new Promise(r=>setTimeout(r,l+200)),M(s,t)},M=(t,e)=>{const s=document.getElementById(t.id);let o;const l=e.map(n=>n.id===t.id?(n.selected=!0,n.lastResult=!0,o=n,n):(n.lastResult=!1,n));m(l),s.classList.add("highlighted"),y.style.display="block",u.style.display="block",y.innerHTML=`<i class="fa-solid fa-circle-check"></i> Resultado: <strong>${t.name}</strong>`,u.innerHTML=`<i class="fa-solid fa-circle-info"></i> Último resultado: ${o.name}`},w=()=>{const e=i().find(s=>s.lastResult===!0);e?(u.style.display="block",u.innerHTML=`<i class="fa-solid fa-circle-info"></i> Último resultado: ${e.name}`):u.style.display="none"},T=()=>{const e=i().map(s=>(s.selected=!1,s.lastResult=!1,s));y.style.display="none",m(e),c(a)},x=()=>{m([]),f.open=!0,c(a)};c(a);w();
