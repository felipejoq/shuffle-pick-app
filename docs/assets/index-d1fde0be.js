(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(l){if(l.ep)return;l.ep=!0;const n=s(l);fetch(l.href,n)}})();const h=document.getElementById("playersForm"),a=document.getElementById("playerList"),p=document.getElementById("getRandomPlayer"),y=document.getElementById("selectedPlayer"),P=document.getElementById("resetGame"),L=document.getElementById("deletePlayerList"),f=document.getElementById("detailsAddPlayers"),E=document.getElementById("playersCount"),u=document.getElementById("lastResult");h.addEventListener("submit",e=>{e.preventDefault();for(const t of e.target.children)if(t.id==="players"){const s=v(t);I(s),t.value="",f.open=!1}c(a)});a.addEventListener("click",e=>{(e.target.type==="button"||e.target.closest("button").type==="button")&&b(e.target.closest("li").id)});p.addEventListener("click",()=>{B()});P.addEventListener("click",()=>{w()});L.addEventListener("click",()=>{x()});const i=()=>JSON.parse(localStorage.getItem("players"))||[],m=e=>{localStorage.setItem("players",JSON.stringify(e))},I=e=>{let t=e.split(/\s*,|\n/);return t=t.filter(s=>s.trim()),t=t.map(s=>({id:R(),name:s,selected:!1,lastResult:!1})),t=[...i(),...t],m(t),t},v=e=>{const t=e.value;if(/<[^>]+>/.test(t))throw new Error("El contenido debe ser solo texto separado por comas o saltos de línea");return t},b=e=>{console.log("Eliminar player con id:",e);const t=i(),s=t.findIndex(o=>o.id===e);t.splice(s,1),m(t),c(a)},c=e=>{e.innerHTML="";const t=i();t.length>0&&(f.open=!1);let s="<ol>";t.forEach(o=>{s+=`
                    <li class="${o.selected?"has-been-selected":""}" id="${o.id}">
                        <span>${o.name}</span>
                        <button class="btn-danger" type="button">
                            x
                        </button>
                    </li>
                `}),s+="</ol>",E.textContent=`(${t.length})`,e.innerHTML=s},R=(e=6)=>Math.random().toString(36).substring(2,e+2),g=()=>{const e=i();return e[Math.floor(Math.random()*e.length)]},B=async()=>{const e=i();if(e.length<=0)return;if(c(a),!e.find(r=>r.selected===!1)){alert("Todos los jugadores ya han participado al menos una vez.");return}let s=g();for(;s.selected;)s=g();const o=document.querySelectorAll("ol li");o.forEach(r=>{r.classList.remove("highlighted")});const l=2e3,n=Date.now()+l,d=setInterval(()=>{let r=Math.floor(Math.random()*o.length);for(;e[r].selected;)r=Math.floor(Math.random()*o.length);o[r].classList.add("highlighted"),setTimeout(()=>{o[r].classList.remove("highlighted")},100),Date.now()>=n&&clearInterval(d)},200);await new Promise(r=>setTimeout(r,l+200)),M(s,e)},M=(e,t)=>{const s=document.getElementById(e.id);let o;const l=t.map(n=>n.id===e.id?(n.selected=!0,n.lastResult=!0,o=n,n):(n.lastResult=!1,n));m(l),console.log(s),s.classList.add("highlighted"),y.style.display="block",u.style.display="block",y.innerHTML=`<i class="fa-solid fa-circle-check"></i> Resultado: <strong>${e.name}</strong>`,u.innerHTML=`<i class="fa-solid fa-circle-info"></i> Último resultado: ${o.name}`},T=()=>{const t=i().find(s=>s.lastResult===!0);t?(u.style.display="block",u.innerHTML=`<i class="fa-solid fa-circle-info"></i> Último resultado: ${t.name}`):u.style.display="none"},w=()=>{const t=i().map(s=>(s.selected=!1,s.lastResult=!1,s));y.style.display="none",m(t),c(a)},x=()=>{m([]),f.open=!0,c(a)};c(a);T();
